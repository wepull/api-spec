# Test generated by RoostGPT for test IPFront-Test using AI Type Open AI and AI Model gpt-4

# RoostTestHash=d0cccd6f73

config:
  target: "{{ $processEnvironment.API_HOST }}"
  plugins:
    expect: {}
  payload:
    path: "alert_post_others.csv"
    fields:
      - "device_id"
      - "status"
    skipHeader: true

scenarios:
  - name: "Test invalid API behaviour"
    flow:
      - log: "Sending invalid request with missing device_id in the payload"
        post:
          url: "/api/device/alert"
          headers:
            Authorization: "{{ $processEnvironment.AUTH_TOKEN }}"
            content-type: "application/json"
          json:
            device_id: ""
            status: "online"
          expect:
            - statusCode: 400
            - hasProperty: "error"
            - equals: 
                - "message"
                - "Invalid device_id"
      - think: 1

      - log: "Sending invalid request with missing status in the payload"
        post:
          url: "/api/device/alert"
          headers:
            Authorization: "{{ $processEnvironment.AUTH_TOKEN }}"
            content-type: "application/json"
          json:
            device_id: "device123"
            status: ""
          expect:
            - statusCode: 400
            - hasProperty: "error"
            - equals: 
                - "message"
                - "Invalid status"
      - think: 1

      - log: "Sending invalid request with wrong URL"
        post:
          url: "/api/device/alerts"
          headers:
            Authorization: "{{ $processEnvironment.AUTH_TOKEN }}"
            content-type: "application/json"
          json:
            device_id: "device123"
            status: "online"
          expect:
            - statusCode: 404
      - think: 1

      - log: "Sending invalid request with wrong authorization token"
        post:
          url: "/api/device/alert"
          headers:
            Authorization: "Invalid_Token"
            content-type: "application/json"
          json:
            device_id: "device123"
            status: "online"
          expect:
            - statusCode: 401
            - hasProperty: "error"
            - equals: 
                - "message"
                - "Unauthorized"
      - think: 1
